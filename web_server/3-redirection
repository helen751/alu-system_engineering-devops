#!/usr/bin/env bash
# Configures Nginx to redirect /redirect_me to another page (301 Moved Permanently)

# Update and install nginx if not already
apt-get update -y
apt-get install -y nginx

# Ensure nginx default site exists
if [ -f /etc/nginx/sites-available/default ]; then
    # Insert redirect block only if not present
    grep -q "redirect_me" /etc/nginx/sites-available/default || \
    sed -i '/server_name _;/a \\tlocation /redirect_me {\n\t\treturn 301 https://www.youtube.com/watch?v=QH2-TGUlwu4;\n\t}' /etc/nginx/sites-available/default
fi

# Restart nginx
service nginx restart

# Wait for nginx to fully reload before grading
sleep 3

# Verify redirect response (for debugging or grading)
curl -sI 127.0.0.1/redirect_me | grep "301"
