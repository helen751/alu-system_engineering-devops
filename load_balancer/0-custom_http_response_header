#!/usr/bin/env bash
# Configures Nginx to add a custom HTTP header X-Served-By

# Install Nginx if not already installed
apt-get update -y
apt-get install -y nginx

# Add custom header line to nginx configuration inside the http block
if ! grep -q "add_header X-Served-By" /etc/nginx/nginx.conf; then
    sed -i '/http {/a \    add_header X-Served-By $hostname always;' /etc/nginx/nginx.conf
fi

# Restart nginx
systemctl restart nginx
